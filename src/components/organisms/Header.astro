---
import Hamburger from "../atoms/Hamburger.astro";
import DayaSolo from "../../assets/icons/logo/dayaSolo.svg";
import MainMenu from "./MainMenu.astro";
---

<header class="header">
  <div class="nav" aria-label="Main navigation">
    <a href="/" aria-label="Accueil"><DayaSolo /> </a>
  </div>
  <div>
    <Hamburger />
  </div>

  <MainMenu />
</header>

<style>
  .header {
    width: 100%;
    min-height: 60px;
    height: 60px;
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: space-between;
    padding: 0 1rem;
    z-index: 9;
    position: sticky;
    top: 0px;
    left: 0;
    right: 0;
    will-change: transform;
    backface-visibility: hidden;
    transform: translateZ(0);
    -webkit-transform: translateZ(0);
  }
  .header svg {
    height: 30px;
    fill: var(--secondary-700);
    width: auto;
    transform-style: preserve-3d;
    display: block;
  }

  .header--scrolled {
    background-color: var(--primary-700);
    transition:
      background-color 0.4s cubic-bezier(0.4, 0, 0.2, 1),
      transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }
</style>

<script>
  // Header bg show on scroll down
  const header = document.querySelector("header");
  const onScroll = () => {
    if (!header) return;
    header.classList.toggle("header--scrolled", window.scrollY > 410);
  };

  // Debounce utility
  let scrollTimeout: number | undefined;
  window.addEventListener("scroll", () => {
    clearTimeout(scrollTimeout);
    scrollTimeout = window.setTimeout(onScroll, 10);
  });

  // Hamburger menu toggle functionality
  const hamburgerBtn = document.querySelector("#hamburger");
  const menu = document.getElementById("main-menu");
  if (hamburgerBtn && menu) {
    hamburgerBtn.addEventListener("click", (e) => {
      e.stopPropagation();
      const expanded = hamburgerBtn.getAttribute("aria-expanded") === "true";
      hamburgerBtn.setAttribute("aria-expanded", String(!expanded));
      menu.setAttribute("aria-hidden", String(expanded));
      menu.hidden = expanded;
    });

  }
</script>
